# DB-001: NullDb.put_impl should silently discard writes, not return StorageError

## Ticket Summary

Change `NullDb.put_impl` and `NullDb.delete_impl` in `client/db/null.zig` to silently discard writes (return `void`) instead of returning `error.StorageError`. Update the 3 affected tests (put, put with null, delete) to verify no-op behavior instead of expecting errors.

**Rationale**: NullDb is a null object for _both_ reads AND writes. Code paths that use NullDb as a universal no-op (e.g., passing it where a Database is required but persistence is unnecessary) currently break on any write operation. The fix makes NullDb a true "black hole" — reads return null, writes silently discard.

## Critical Design Note

**Nethermind's NullDb.cs DOES throw on writes** (`Set` throws `NotSupportedException`, `Remove` throws `NotSupportedException` — see lines 29-30, 38-39 of `NullDb.cs`). This ticket intentionally deviates from Nethermind to make NullDb more useful as a universal no-op in Zig. This is a deliberate design choice, not a bug fix to match Nethermind.

## PRD Reference

**Phase 0: DB Abstraction Layer** (`prd/GUILLOTINE_CLIENT_PLAN.md`, lines 14-28)
- Key components: `client/db/adapter.zig`, `client/db/rocksdb.zig`, `client/db/memory.zig`
- NullDb is part of the DB abstraction layer
- No external spec dependencies per `prd/ETHEREUM_SPECS_REFERENCE.md` (lines 18-26): "Specs: N/A (internal abstraction)"

## Spec Reference

**N/A** — This is an internal DB abstraction change. The DB layer has no Ethereum spec requirements (Phase 0 is purely internal infrastructure).

## Nethermind Reference Files

| File | Purpose | Key Observation |
|------|---------|-----------------|
| `nethermind/src/Nethermind/Nethermind.Db/NullDb.cs` | Null object DB pattern | `Set()` throws `NotSupportedException`, `Remove()` throws `NotSupportedException`. Singleton pattern via `LazyInitializer`. Get returns null, KeyExists returns false, Flush/Clear are no-ops. |
| `nethermind/src/Nethermind/Nethermind.Db/NullRocksDbFactory.cs` | Sentinel factory | `CreateDb()` throws `InvalidOperationException`. Different from NullDb — this prevents DB creation entirely. |

**Note**: Our `NullDbFactory` (in `factory.zig`) is the equivalent of Nethermind's `NullRocksDbFactory` and correctly returns `error.UnsupportedOperation` on `createDb`. That behavior should NOT change — it's the factory that rejects creation, not an existing NullDb instance.

## Voltaire APIs

**Voltaire does NOT provide DB primitives**. Confirmed by previous research (DB-001 context). The DB abstraction layer (`client/db/`) is entirely local. Voltaire provides higher-level state management (`StateManager`, `JournaledState`, caches) that sits above the DB layer.

No Voltaire types are relevant to this change.

## Existing Implementation Files

### Primary file to modify:
| File | Lines | Purpose |
|------|-------|---------|
| `client/db/null.zig` | 255 lines | NullDb implementation + 9 tests |

### Key functions to change:
- `put_impl` (line 79-82): Currently returns `error.StorageError` → change to no-op (return `void`)
- `delete_impl` (line 84-87): Currently returns `error.StorageError` → change to no-op (return `void`)

### Tests to update (3 tests):
1. `"NullDb: put returns StorageError"` (line 183-189): Change to verify put succeeds silently
2. `"NullDb: put with null returns StorageError"` (line 191-197): Change to verify put-null succeeds silently
3. `"NullDb: delete returns StorageError"` (line 199-205): Change to verify delete succeeds silently

### Doc comments to update:
- Module-level doc (lines 1-13): Change "All write operations return `error.StorageError`" to "All write operations silently discard data"
- Struct-level doc: No changes needed (doesn't mention write behavior)
- `root.zig` line 78: Change "Null object backend (reads return null, writes error)" to "Null object backend (reads return null, writes silently discard)"

### Secondary file (guillotine-mini copy):
| File | Lines | Purpose |
|------|-------|---------|
| `guillotine-mini/client/db/null.zig` | 257 lines | Older copy of NullDb (uses raw vtable instead of Database.init helper) |

**Note**: The `guillotine-mini/` copy has the same issue but uses a different vtable wiring pattern (raw `*anyopaque` functions vs `Database.init` comptime helper). It should be updated consistently.

### Files that reference NullDb but need NO changes:
- `client/db/root.zig` — Re-exports NullDb; doc comment on line 78 should be updated
- `client/db/factory.zig` — `NullDbFactory` is separate from `NullDb`; no changes needed
- `client/db/bench.zig` — References NullDbFactory only; no changes needed
- `client/db/rocksdb.zig` — Mentions NullDb in comments; no changes needed

## Test Fixtures

**N/A** — No external test fixtures for DB abstraction (Phase 0 is internal). All testing is via inline unit tests.

## Impact Analysis

### Code paths that currently break with NullDb writes:
Any consumer that does `db.put(key, value)` with a NullDb backend will get `error.StorageError`. After this fix, writes will silently succeed (no error, no storage).

### Code paths unaffected:
- `NullDb.get_impl` — Already returns null (no change)
- `NullDb.contains_impl` — Already returns false (no change)
- `NullDb.flush_impl`, `clear_impl`, `compact_impl` — Already no-ops (no change)
- `NullDb.iterator_impl`, `snapshot_impl` — Already work (no change)
- `NullDbFactory` — Separate type, returns `error.UnsupportedOperation` on createDb (no change)

### Risk:
- LOW — NullDb is a test/diagnostic utility. No production code path depends on NullDb write errors.
- The `ReadOnlyDb` strict mode already provides the "writes return error" behavior for code that needs it.

## Implementation Steps

1. Change `put_impl` in `client/db/null.zig` to return `{}` (void) instead of `error.StorageError`
2. Change `delete_impl` in `client/db/null.zig` to return `{}` (void) instead of `error.StorageError`
3. Update comment on `put_impl` from "writes are not supported" to "silently discarded (null object pattern)"
4. Update comment on `delete_impl` similarly
5. Update module-level doc comment
6. Update the 3 test cases to verify silent success
7. Update `root.zig` doc comment (line 78)
8. Update `guillotine-mini/client/db/null.zig` consistently (same put_impl/delete_impl changes + tests)
9. Run `zig fmt client/db/null.zig`
10. Run tests to verify all pass
